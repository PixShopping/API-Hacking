<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./style.css">
  <title>Hacking</title>

</head>
<body>

  <main class="container">

    <h1>Consultar Dados</h1>
    <input id="nome" placeholder="Nome da Pessoa" type="text">
    <button onclick="consultarDados()">Pesquisar</button>
    
  </main>

  <section id="resultado" class="resultados">

    <article class="noticias">
      
      <h1>Notícias: </h1>

    </article>

    <article class="websites">
      
      <h1>Websites: </h1>

    </article>

  </section>

  <div class="divCarregando">
    <section class="carregando">
        <span></span>
        <h2>Carregando..</h2>
    </section>
  </div>

  

  <script>
    function consultarDados() {
        //const apiUrl = 'https://apipuppeteer.onrender.com/login'; // Substitua pela URL da sua API
        const apiUrl = 'https://api-hack.onrender.com/consultar'; // Substitua pela URL da sua API
        const usuario = document.getElementById('nome').value;
        const resultados = document.querySelector('.resultados');
        const noticias = document.querySelector('.noticias');
        const websites = document.querySelector('.websites');
        const carregando = document.querySelector('.divCarregando');
        
        carregando.style.display = "flex";
        resultados.style.display = "none";

        fetch(apiUrl + `?nome=${usuario}`)
            .then(response => response.json())
            .then((data) => {
              document.body.style.overflowY = "auto";
              resultados.style.display = "flex";
              window.location.href = "#resultado";
              carregando.style.display = "none";

              const news = data.noticias;
              news.forEach((noticia) => {
                var titulo = noticia.titulo;
                var texto = noticia.texto;
                var dominio = noticia.dominio;
                noticias.innerHTML += `
                  <div class="arquivo">
                    <h1>${titulo}</h1>
                    <p>${texto}</p>
                    <a>${dominio}</a>
                  </div>
                `;  
              });
              const web = data.websites;
              console.log(web)
              web.forEach((site) => {
                var titulo = site.titulo;
                var texto = site.texto;
                var dominio = site.dominio;
                websites.innerHTML += `
                  <div class="arquivo">
                    <h1>${titulo}</h1>
                    <p>${texto}</p>
                    <a>${dominio}</a>
                  </div>
                `;            
              });
            })
            .catch(error => {
              console.error('Erro na solicitação GET:', error);
            });
    }
  </script>
</body>
</html>